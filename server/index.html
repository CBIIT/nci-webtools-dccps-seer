<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JPsurv Analysis Tool</title>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DGFTR3EY14"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-DGFTR3EY14');
  </script>

  <script
    src="https://assets.adobedtm.com/f1bfa9f7170c81b1a9a9ecdcc6c5215ee0b03c84/satelliteLib-4b219b82c4737db0e1797b6c511cf10c802c95cb.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.8.7/polyfill.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.1/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/additional-methods.min.js"></script>
  <script src="js/jpsurv.js" type="module"></script>
  <script src="js/plots.js" type="module"></script>
  <script src="queueProcessor/services/xlsxExport.js" type="module"></script>
  <script src="js/exportImport.js" type="module"></script>
  <script src="https://cbiit.github.io/nci-softwaresolutions-elements/components/include-html.js"></script>
  <script src="js/joinpointConditional.js" type="module"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.1/css/bootstrap.min.css"
    integrity="sha512-T584yQ/tdRR5QwOpfvDfVQUidzfgc2339Lc8uBDtcp/wYu80d7jwBgAxbyMh0a9YM9F8N3tdErpFI8iaGx6x5g=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css" />
  <link rel="stylesheet" href="css/jpsurv.css" />
  <link rel="icon" type="image/png" href="images/seer_logo.png" />
</head>

<body role="document" class="bg-light">
  <a class="sr-only sr-only-focusable" title="Skip to content" href="#main">Skip to content</a>
  <header>
    <include-html
      src="https://cbiit.github.io/nci-softwaresolutions-elements/banners/government-shutdown.html"></include-html>
    <div class="container px-0">
      <a href="https://cancercontrol.cancer.gov/" target="DCCPS">
        <img class="img-responsive" src="./images/nci_dccps.svg" id="logo"
          alt="National Cancer Institute: Division of Cancer Control and Population Sciences"
          title="National Cancer Institute: Division of Cancer Control and Population Sciences" />
      </a>
    </div>
    <div id="header" role="banner">
      <div class="container px-0">
        <div id="ribbon" class="clearfix bg-primary">
          <div class="wrapper">
            <h1>
              <a href="/" title="Return to SRP Home">Surveillance Research Program</a>
            </h1>
          </div>
        </div>
      </div>
    </div>
  </header>
  <div class="bg-dark w-100">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark p-0" role="navigation">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
          aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
          <div class="navbar-nav">
            <a class="nav-item nav-link active" id="analysisNav" href="#analysis">Analysis</a>
            <a class="nav-item nav-link" id="helpNav" href="#help">Help</a>
          </div>
        </div>
      </nav>
    </div>
  </div>
  <!-- CONTENTS Section -->

  <div id="main" class="container">
    <div class="row">
      <div class="col-lg-12 col-lg-offset-1 w-100 ml-0" id="jpsurv-message-container" style="display: none">
        <div class="card bg-white">
          <div class="card-header bg-danger">Error</div>
          <div class="card-body">
            <p id="jpsurv-message-content"></p>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <!-- Upload FORM - STAGE 1 -->
      <div id="slideoutTab" class="col-md-12 col-lg-4">
        <i id="icon" class="fa-solid fa-caret-left fa-2x hidden-xs hidden-sm" onclick="Slide_menu_Horz()"
          style="visibility: hidden; margin-left: 100%"></i>
        <div id="slideoutForm" class="card bg-white border rounded">
          <div class="card-body">
            <span class="jpsurv-title col-md-6 d-none d-sm-block d-md-block"><img src="./images/jpsurv.png"
                style="height: 60%; width: 60%" alt="JPSurv (Joint Point Survival Model)" /></span>

            <span class="jpsurv-title col-md-12 d-block d-sm-none d-md-none"><img src="./images/jpsurv.png"
                style="height: 60%; width: 40%" alt="JPSurv (Joint Point Survival Model)" /></span>

            <div id="slideout">
              <div class="">
                <!-- <span
                    class="float-right col-md-5 cursor text-right"
                    onclick="openHelpWindow('./html/help.html')"
                  >
                    <a href="#">
                      <i class="fas fa-question-circle" aria-label="Help"></i>
                      <span>Help</span>
                    </a>
                  </span> -->
                <!-- Upload FORM - STAGE 1 -->
                <div class="box col-xs-12 border rounded" style="overflow: hidden; width: 100%">
                  <form id="upload-form" class="form-horizontal" role="form" method="post" enctype="multipart/form-data"
                    action="jpsurvRest/stage1_upload">
                    <label class="col-xs-3 font-weight-bold" id="inputTypeLabel">File Format:</label>
                    <div id="input_type_select" style="margin-bottom: 2%" class="d-flex">
                      <div class="custom-control custom-radio custom-control-inline" data-toggle="tooltip"
                        data-placement="top" title="SEER*Stat survival text and dictionary files">
                        <input type="radio" id="dic" name="data" value="dic" class="custom-control-input" checked />
                        <label class="custom-control-label" for="dic" aria-label="dictionary">Dic/Data Files</label>
                      </div>
                      <div class="custom-control custom-radio custom-control-inline" data-toggle="tooltip"
                        data-placement="top" title="SEER Data File">
                        <input type="radio" id="csv" name="data" value="csv" class="custom-control-input" />
                        <label class="custom-control-label" for="csv" aria-label="csv">CSV Files</label>
                      </div>
                      <div class="custom-control custom-radio custom-control-inline" data-toggle="tooltip"
                        data-placement="top" title="Import a JPSurv workspace exported previously">
                        <input type="radio" id="importRadioButton" name="data" value="importRadioButton"
                          class="custom-control-input" />
                        <label class="custom-control-label" for="importRadioButton"
                          aria-label="importRadioButton">Workspace</label>
                      </div>
                    </div>
                    <div id="seperator" class="row row-no-gutters">
                      <hr class="stage-separator" />
                    </div>
                    <div id="dic_container">
                      <div id="file_control_container" class="mx-0 mb-0">
                        <div class="mb-2">
                          <label class="font-weight-bold" for="file_control">SEER Stat Dictionary/Data Files:</label>
                          <a style="font-size: small; color: #3273ab" href="./data/Tutorial_JPSURV.dic"
                            download="Tutorial_JPSURV.dic">(dic example)</a>
                          <a style="font-size: small; color: #3273ab" href="./data/Tutorial_JPSURV.txt"
                            download="Tutorial_JPSURV.txt">(txt example)</a>
                        </div>
                        <div class="input-group mb-2">
                          <div class="custom-file">
                            <input type="file" class="custom-file-input" id="file_control" name="file_control"
                              accept=".dic, .txt" aria-label="dictionary file chooser" multiple max-uploads="2" />
                            <span class="custom-file-label">Choose files (dic, txt)</span>
                          </div>
                          <div class="input-group-append">
                            <button class="btn btn-primary upload_file_submit" id="upload_dictxt" data-toggle="tooltip"
                              data-placement="left" type="button" disabled>
                              Upload
                            </button>
                          </div>
                        </div>
                        <div id="file_display"></div>
                      </div>
                      <div id="file_data_container" class="mx-0 mb-0"></div>
                    </div>

                    <div id="csv_container" style="display: none">
                      <div id="file_control_container_csv" class="mx-0 mb-0">
                        <div class="mb-2">
                          <label class="font-weight-bold" for="file_control_csv">CSV File:</label>
                          <a style="font-size: small; color: #3273ab" href="./data/Breast_RelativeSurvival_Head_NA0.csv"
                            download="Breast_RelativeSurvival_Head_NA0.csv">(example)</a>
                          <button type="button" class="btn btn-light btn-sm float-right" id="Adv_input"
                            style="background-color: buttonface" disabled>
                            Configure CSV
                          </button>
                        </div>

                        <div class="input-group mb-2">
                          <div class="custom-file">
                            <input type="file" class="custom-file-input" id="file_control_csv" name="file_control_csv"
                              accept=".csv, .txt" aria-label="csv file chooser" />
                            <label class="custom-file-label" for="file_control_csv">Choose file (csv, txt)</label>
                          </div>
                          <div class="input-group-append">
                            <button class="btn btn-primary upload_file_submit" id="upload_csv" data-toggle="tooltip"
                              data-placement="left" type="button" disabled>
                              Upload
                            </button>
                          </div>
                        </div>
                        <div id="file_display_csv"></div>
                      </div>
                    </div>
                    <div id="import_container" style="display: none">
                      <div class="mb-2">
                        <label class="font-weight-bold" for="import_container"> Workspace file: </label>
                      </div>
                      <div class="input-group mb-2">
                        <div class="custom-file">
                          <input type="file" class="custom-file-input" id="fileSelect" name="fileSelect"
                            accept=".jpsurv" aria-label="Import" value="Import" title="Import" />
                          <label class="custom-file-label" for="fileSelect">Choose file (*.jpsurv)</label>
                        </div>
                        <div class="input-group-append">
                          <button class="btn btn-primary upload_file_submit" id="upload_session" data-toggle="tooltip"
                            data-placement="left" type="button" disabled>
                            Import
                          </button>
                        </div>
                      </div>
                      <div id="file_display_workspace"></div>
                    </div>
                    <div id="data_type_container" class="mx-0 mb-0"></div>
                  </form>
                </div>
                <!-- Calculate - STAGE 2 -->
                <div id="stage2-calculate" class="box col-xs-12 border rounded" style="display: none">
                  <form id="parameters" class="form-horizontal" novalidate>
                    <h5 class="card-title">Cohort and Model Specifications</h5>
                    <hr class="stage-separator" />
                    <div id="diagnosis_title"></div>
                    <div class="jpsurv-label-container">
                      <span class="jpsurv-label">Year of Diagnosis Range:
                        <span>
                          <span class="jpsurv-label-content font-weight-normal">
                            <label for="year_of_diagnosis_start" class="d-none">Start Year</label>
                            <select id="year_of_diagnosis_start" name="year_of_diagnosis_start"></select>
                            to
                            <label for="year_of_diagnosis_end" class="d-none">End Year</label>
                            <select id="year_of_diagnosis_end" name="year_of_diagnosis_end"></select>
                          </span>
                        </span>
                      </span>
                    </div>
                    <div class="jpsurv-label-container d-flex">
                      <div class="jpsurv-label" style="width: 250px">
                        Max No. of Years from Diagnosis (follow-up) to include:
                      </div>
                      <div class="jpsurv-label-content font-weight-normal">
                        <label for="intervals_from_diagnosis" class="d-none">Select</label>
                        <select id="intervals_from_diagnosis" name="intervals_from_diagnosis"></select>
                      </div>
                    </div>
                    <div id="cohort-variables"></div>

                    <div id="popover" class="mx-0 mb-0 jpsurv-label-container" style="display: none">
                      <label class="jpsurv-label" for="covariate_select">Covariates:</label>
                      <select id="covariate_select" class="jpsurv-label-content" name="covariate_select"
                        name="selectList"></select>
                    </div>
                    <div class="form-group">
                      <label for="max_join_point_select" class="jpsurv-label">Maximum Joinpoints:</label>
                      <select id="max_join_point_select" class="jpsurv-label-content" name="max_join_point_select">
                        <option>0</option>
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                      </select>
                      <i class="fas fa-question-circle" title="maximum joinpoints help info" id="max_help"
                        data-toggle="popover" tabindex="0" data-trigger="focus" data-placement="right"
                        data-content="Most common situation is to have 0 or 1 joinpoint since survival trends change gradually. Begin with small number of joinpoints. Increase the number if there is not a good fit or to be sure you capture all joinpoints. Computation time increases exponentially with number of joinpoints tested."></i>
                    </div>
                    <div>
                      <div class="jpsurv-label-container">
                        <div class="form-group form-check">
                          <input type="checkbox" class="form-check-input" name="toggleConditionalJp"
                            id="toggleConditionalJp" />
                          <label class="form-check-label jpsurv-label" for="toggleConditionalJp">Conditional Survival
                            Model Using Truncated Data</label>
                        </div>
                        <div id="conditionalForm" class="form d-none">
                          <div class="row">
                            <div class="form-group mb-0 col-sm-auto">
                              <label class="font-weight-bold" for="condIntStart">Start Interval:</label>
                              <select id="condIntStart" name="condIntStart" class="mx-3"
                                aria-label="interval start"></select>
                            </div>
                            <div class="form-group mb-0 col-sm-auto">
                              <label class="font-weight-bold" for="condIntEnd">End Interval:</label>
                              <select id="condIntEnd" name="condIntEnd" class="mx-3" aria-label="end"></select>
                            </div>
                          </div>
                          <div class="row">
                            <label id="condIntStart-error" for="condIntStart" class="text-danger error col-sm-auto">
                            </label>
                          </div>
                        </div>
                      </div>
                      <div class="form-group form-check">
                        <input type="checkbox" class="form-check-input" name="toggleRelaxProp" id="toggleRelaxProp" />
                        <label class="jpsurv-label" for="toggleRelaxProp">Relax Proportionality</label>
                        <p class="text-muted">
                          Relaxing the proportionality assumption will require additional compute time
                        </p>
                      </div>
                      <div id="relaxPropForm" class="form-group d-none">
                        <label class="font-weight-bold" for="maxCutPoint">Cut Point:</label>
                        <select id="maxCutPoint" name="maxCutPoint" class="mx-3" aria-label="end" disabled
                          required></select>
                        <p class="text-muted">
                          The cut-point is the time after diagnosis that splits data into two groups. Cluster 1
                          includes years 1 to the cut-point. Separate JPSurv models are applied to each cluster.
                        </p>
                      </div>
                    </div>
                    <div class="row">
                      <div id="e-mail-msg" class="e-mail-grp" style="padding: 5px 15px; display: none"></div>
                    </div>
                    <div class="mx-0 mb-0 e-mail-grp" style="display: none">
                      <label for="e-mail" class="jpsurv-label" title="Enter a valid e-mail">E-mail:</label>
                      <input class="arrow" tabindex="0" required id="e-mail" type="email"
                        placeholder="Enter e-mail address" title="Enter a valid e-mail address."
                        aria-label="Email Address" />
                    </div>
                    <div class="row">
                      <div class="advanced ml-auto mr-3" onclick="Slide_menu_Vert('stage2b-advanced','both')">
                        Advanced Options
                      </div>
                    </div>

                    <!-- Advanced Options - STAGE 2b -->
                    <div class="box col-md-12 border rounded" div id="stage2b-advanced" style="display: none">
                      <h2 class="h4">Advanced Options</h2>
                      <hr class="stage-separator" />
                      <div id="adv-options">
                        <!-- Delete Last Interval -->
                        <div class="row" style="margin-bottom: 10px">
                          <label for="adv-delete-interval" class="mr-auto">Delete Last Interval:</label>
                          <div class="ml-auto">
                            <form id="adv-delete-interval">
                              <div class="custom-control custom-radio custom-control-inline">
                                <input class="custom-control-input" type="radio" id="del-int-yes" value="Yes"
                                  name="adv-delete-interval" aria-label="Yes" />
                                <label class="custom-control-label" for="del-int-yes">Yes</label>
                              </div>
                              <div class="custom-control custom-radio custom-control-inline">
                                <input class="custom-control-input" type="radio" id="del-int-no" value="No"
                                  name="adv-delete-interval" aria-label="No" checked />
                                <label class="custom-control-label" for="del-int-no">No</label>
                              </div>
                            </form>
                          </div>
                        </div>
                        <!-- Skipped Observations between (adv-between)-->
                        <div class="row form-inline pb-3">
                          <label for="adv-between" class="mr-auto">Minimum Number of Years between Joinpoints (Excluding
                            Joinpoints):
                          </label>
                          <input id="adv-between" type="number" class="form-control ml-auto sm-input" value="2" min="2"
                            required aria-label="adv-between" />
                        </div>

                        <!-- Skipped Obervations from First (adv-first) -->
                        <div class="row form-inline pb-3">
                          <label for="adv-first" class="mr-auto">Minimum Number of Years before First Joinpoint
                            (Excluding Joinpoint):
                          </label>
                          <input id="adv-first" type="number" class="form-control ml-auto sm-input" value="3" min="2"
                            required aria-label="adv-first" />
                        </div>

                        <!-- Skipped Obervations to Last (adv-last) -->
                        <div class="row form-inline pb-3">
                          <label for="adv-last" class="mr-auto">Minimum Number of Years after Last Joinpoint (Excluding
                            Joinpoint):
                          </label>
                          <input id="adv-last" type="number" class="form-control ml-auto sm-input" value="5" min="2"
                            aria-label="adv-last" />
                        </div>
                        <!-- Number of Calendar Year of Project (adv-year) -->
                        <div class="row form-inline pb-3">
                          <label for="adv-year" class="mr-auto">Number of Calendar Years of Projected Survival:</label>
                          <input id="adv-year" type="number" class="form-control ml-auto sm-input" value="5" min="0"
                            required aria-label="adv-year" />
                        </div>

                        <div class="row justify-content-between">
                          <div class="col-sm-auto advanced" onclick="resetAdvancedOptions()">
                            Reset Advanced Options
                          </div>
                          <div class="col-sm-auto advanced" onclick="Slide_menu_Vert('stage2b-advanced','both')">
                            Hide
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="d-flex justify-content-end">
                      <button type="button" onclick="window.location.href='.'" class="btn btn-primary btn-sm"
                        title="Reset all values" aria-label="Reset">
                        Reset
                      </button>
                      <button type="submit" id="calculate" class="btn btn-primary btn-sm ml-3" aria-label="calculate"
                        disabled>
                        Calculate
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- </form> -->
      <!-- Main Menu Tabs -->
      <div class="card col-md-12 col-lg-8 border rounded bg-white" id="descriptionCard" style="margin-top: 2rem">
        <div id="description" class="card-body h-auto overflow-auto">
          <div class="row">
            <div class="col-sm-7 col-sm-offset-2" id="jpsurv-help-message-container"
              style="display: none; margin-top: 2%">
              <div class="card">
                <div class="card-header bg-warning">Warning</div>
                <div class="card-body">
                  <p id="jpsurv-message-content"></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="right_panel" class="col-md-12 col-lg-8" style="display: none; margin-top: 2%">
        <div id="cohort-join-points" class="card bg-white border rounded mb-4 shadow-sm">
          <div class="card-body">
            <div class="d-flex pb-3">
              <div class="d-inline">
                <label for="cohort-display" class="font-weight-bold">Cohort</label>
                <select id="cohort-display" aria-label="cohort display"></select>
              </div>
              <div id="cutpoint-display-control" class="ml-3 d-none">
                <label for="cutpoint-display" class="font-weight-bold">Cut Point</label>
                <select id="cutpoint-display" aria-label="select cut point"></select>
              </div>
              <div class="d-inline ml-3">
                <label for="precision" title="Rounded to decimal places.">Number of Decimal Places</label>
                <select name="abcselect" id="precision" aria-label="Round">
                  <option>1</option>
                  <option selected>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5</option>
                  <option>6</option>
                  <option>7</option>
                  <option>8</option>
                  <option>9</option>
                </select>
              </div>
              <div class="ml-auto">
                <button id="full-dataset-link" class="btn btn-link" data-toggle="tooltip"
                  title="Downloads results for all cohort and joinpoint combinations. May experience long processing times if many cohorts and joinpoints were used.">
                  <span id="full-dataset-spinner" class="spinner-border spinner-border-sm d-none" role="status"
                    aria-hidden="true"></span>
                  Download Full Dataset
                </button>
                <button id="exportButton" class="btn btn-link" data-toggle="tooltip"
                  title="Export cohort, model specification, and results to a workspace file."
                  aria-label="Export workpsace">
                  <span id="export-workspace-spinner" class="spinner-border spinner-border-sm d-none" role="status"
                    aria-hidden="true"></span>
                  Export Workspace
                </button>
              </div>
            </div>
            <form id="clusterControl" class="mb-3">
              <!-- <input type="checkbox" class="custom-control-input" id="toggleConditionalView" checked="true" />
                <label class="custom-control-label" for="toggleConditionalView">Conditional Cluster</label> -->
              <span class="font-weight-bold">View&nbsp;</span>
              <div class="custom-control custom-radio custom-control-inline">
                <input type="radio" id="viewCluster1" name="viewCluster" value="unconditional"
                  class="custom-control-input" checked />
                <label class="custom-control-label" for="viewCluster1">Cluster 1</label>
              </div>
              <div class="custom-control custom-radio custom-control-inline">
                <input type="radio" id="viewCluster2" name="viewCluster" value="conditional"
                  class="custom-control-input" />
                <label class="custom-control-label" for="viewCluster2">Cluster 2</label>
              </div>
              <!-- <div class="custom-control custom-radio custom-control-inline">
                  <input
                    type="radio"
                    id="viewCluster3"
                    name="viewCluster"
                    value="merged"
                    class="custom-control-input"
                  />
                  <label class="custom-control-label" for="viewCluster3">Combined</label>
                </div> -->
            </form>
            <div class="table-responsive">
              <table id="model-selection-table" class="table table-hover condense" tabindex="0">
                <thead>
                  <tr>
                    <th scope="col">Model #</th>
                    <th scope="col">Number of Joinpoints</th>
                    <th scope="col">Location</th>
                    <th scope="col">Bayesian Information Criterion (BIC)</th>
                    <th scope="col">Akaike Information Criterion (AIC)</th>
                    <th scope="col">Log Likelihood</th>
                    <th scope="col">Converged</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
            <div id="cutpointInfo" class="container border rounded p-3 d-none">
              <div class="row">
                <div class="col-sm-auto"><b>Fit Statistics for Both Clusters Combined</b></div>
              </div>
              <div class="row">
                <div class="col-sm-auto font-weight-bold">
                  Total BIC: <span id="totalBic" class="font-weight-normal"></span>
                </div>
                <div class="col-sm-auto font-weight-bold">
                  Total AIC: <span id="totalAic" class="font-weight-normal"></span>
                </div>
                <div class="col-sm-auto font-weight-bold">
                  Total Log Likelihood: <span id="totalLog" class="font-weight-normal"></span>
                </div>
                <div class="col-sm-auto font-weight-bold">
                  Cluster Penalized BIC: <span id="cpBic" class="font-weight-normal"></span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Conditional Joinpoint Form -->
        <div class="accordion mb-3 shadow-sm" id="conditionalRecalcVis">
          <div class="card">
            <div class="card-header" id="headingOne">
              <button class="btn btn-link btn-block text-left shadow-none collapsed" type="button"
                data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                <b>Conditional Survival Calculation</b>
              </button>
            </div>
            <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#conditionalRecalcVis">
              <div class="card-body p-0">
                <form id="conditionalJoinpointForm" novalidate>
                  <div class="row">
                    <div class="col-sm-10 border-right p-4">
                      <b class="ml-4 mb-3">
                        Support for <i>Survival vs. Year at Diagnosis</i> and
                        <i>Survival vs. Time since Diagnosis</i> only
                      </b>
                      <div class="custom-control custom-checkbox form-group ml-4">
                        <input class="custom-control-input" type="checkbox" id="useConditionalJp" />
                        <label class="custom-control-label font-weight-bold" for="useConditionalJp"
                          aria-label="Conditional survival recalculation based on model previously fit to all intervals">Conditional
                          survival recalculation based on model previously fit to all intervals:</label>
                      </div>
                      <div id="conditionalIntervalContainer" class="ml-4">
                        <div id="conditionalIntervalForm-0" class="conditionalIntervalForm d-flex">
                          <div class="d-block">
                            <div class="form-group mb-0 mr-3">
                              <label class="font-weight-bold" for="intervalStart0">Start Interval:</label>
                              <select id="intervalStart0" name="intervalStart0" class="conditionalIntervalStart mx-3"
                                aria-label="start" disabled required></select>
                              <label id="intervalStart0-error" for="intervalStart0" class="text-danger error"></label>
                            </div>
                          </div>
                          <div class="form-group mb-0">
                            <label class="font-weight-bold" for="intervalEnd0">End Interval:</label>
                            <select id="intervalEnd0" name="intervalEnd0" class="conditionalIntervalEnd mx-3"
                              aria-label="end" disabled required></select>
                          </div>
                          <button id="addConditionalInterval" type="button" class="btn btn-link mb-4" disabled>
                            + Add Interval
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-2 d-flex p-4 justify-content-center align-items-center">
                      <button id="recalculateConditional" class="btn btn-primary btn-sm" type="submit" disabled>
                        Recalculate
                      </button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>

        <!-- Message Panel for Error or Warning-->
        <div class="card border rounded shadow-sm">
          <div class="card-header">
            <div class="d-flex">
              <ul id="jpsurv-tabs" class="nav nav-tabs card-header-tabs font-weight-bold flex-nowrap">
                <li class="nav-item">
                  <a class="nav-link active" id="graph-year-link" href="#graph-year-tab" data-toggle="tab">Survival vs.
                    Year at Diagnosis</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="graph-death-link" href="#graph-death-tab" data-toggle="tab">Death vs. Year at
                    Diagnosis</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="graph-time-link" href="#graph-time-tab" data-toggle="tab">Survival vs. Time
                    Since Diagnosis</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="estimates-link" href="#estimates-tab" data-toggle="tab">Model Estimates</a>
                </li>
              </ul>
            </div>
          </div>

          <!-- TABS HERE -->
          <div class="card-body">
            <div class="tab-content border-0">
              <!-- Graphs here -->
              <div id="graph-year-tab" class="tab-pane fade show active">
                <div class="border rounded mb-1">
                  <div class="row">
                    <div class="col-sm-10 border-right">
                      <div class="row">
                        <div class="col-sm-auto m-3">
                          <div class="form-group">
                            <label for="interval-years" class="align-self-center ml-1 mr-3">
                              Select years since diagnosis (follow-up) for survival plot and/or trend measures
                            </label>
                            <select id="interval-years" name="interval-years" class="mx-1" multiple></select>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-auto m-3">
                          <span class="font-weight-bold">Include Trend Measures</span>
                        </div>
                        <div class="col-md-auto m-3">
                          <div class="custom-control custom-checkbox">
                            <input class="custom-control-input" type="checkbox" id="showYearTrend" />
                            <label class="custom-control-label" for="showYearTrend" aria-label="show year trend">Between
                              Joinpoints</label>
                          </div>
                        </div>
                        <div class="col-md-auto m-3">
                          <div class="d-flex">
                            <span class="custom-control custom-checkbox mr-2">
                              <input class="custom-control-input" type="checkbox" id="toggleAbsSelect" />
                              <label class="custom-control-label" for="toggleAbsSelect"
                                aria-label="Toggle Absolute Change Years Select" data-toggle="tooltip"
                                data-placement="top" title="Average Absolute Change over Calendar Year Interval">
                                Between Calendar Years of Diagnosis From
                              </label>
                            </span>
                            <span id="absSelect">
                              <!-- <label
                                  class="mr-2 custom-control-label"
                                  data-toggle="tooltip"
                                  data-placement="top"
                                  title="Average Absolute Change over Calendar Year Interval"
                                  >From</label
                                > -->
                              <select disabled aria-label="from" id="absChgFrom" class="mx-1"></select>
                              <label for="absChgTo" class="mx-2">to</label>
                              <select disabled id="absChgTo" class="mx-1"></select>
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-2 d-flex pl-0 justify-content-center align-items-center">
                      <div class="row">
                        <div class="col">
                          <div id="warning-wrapper">
                            <button class="btn btn-primary btn-sm recalculate" type="button">Recalculate</button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div id="yearTrendTable" class="d-none mb-4">
                  <div class="d-flex">
                    <h4 id="yearTrendHeader">Average Absolute Change in Survival</h4>
                    <span class="text-secondary ml-2 pt-1">*</span>
                  </div>
                  <div class="table-responsive">
                    <table id="trend-aac" class="table table-striped table-hover table-condensed condense" tabindex="0">
                      <thead>
                        <tr>
                          <th scope="col">Interval</th>
                          <th scope="col">Start Year</th>
                          <th scope="col">End Year</th>
                          <th scope="col">Estimate pp</th>
                          <th scope="col">Standard Error pp</th>
                          <th scope="col">Lower Limit 95% C.I.</th>
                          <th scope="col">Upper Limit 95% C.I.</th>
                          <th scope="col">Significance</th>
                        </tr>
                      </thead>
                      <tbody></tbody>
                    </table>
                  </div>
                  <div id="footnote">
                    <sup>*Numbers represent the difference in cumulative survival rate (as the percent surviving) from
                      one year at diagnosis to the previous.</sup>
                  </div>
                  <div>
                    <sup>Plot: Annotations only available when less than four interval years or four joinpoints are
                      selected.</sup>
                  </div>
                </div>

                <div class="row px-3 mb-1">
                  <button id="addYearAnno" type="button" class="btn btn-link col-sm-auto addPlotAnno">
                    + Add Annotation
                  </button>
                  <div class="d-flex mb-0 align-self-center form-group col-sm-auto">
                    <label class="mb-0 align-self-center" for="yearFont">Plot Font Size</label>
                    <input type="number" id="yearFont" name="yearFont" class="form-control ml-2 fontControl" min="12"
                      max="20" value="14" />
                  </div>
                  <div id="yearAnnoControl" class="col-sm-auto custom-control custom-checkbox ml-4 align-self-center">
                    <input class="custom-control-input" type="checkbox" id="yearAnno" name="yearAnno" />
                    <label class="custom-control-label" for="yearAnno" aria-label="showTrendsOnGraph">Hide Trend
                      Label</label>
                  </div>
                </div>

                <div class="row">
                  <img class="mx-auto mt-1 d-none" src="" alt="graph-year" />
                  <div id="yearPlot" class="mx-auto mt-1 d-block"></div>
                </div>
                <div class="d-flex">
                  <span id="year-tab-rows" class="mr-auto" style="padding: 0.375rem 0.75rem"></span>
                  <button id="graph-year-dataset-link" class="btn btn-link ml-auto" data-toggle="tooltip"
                    title="Download data used to plot this graph.">
                    Download Graph Dataset
                  </button>
                </div>
                <div class="table-responsive" style="max-height: 500px">
                  <table id="graph-year-table" class="table table-hover table-striped table-condensed condense"
                    tabindex="0">
                    <thead>
                      <tr>
                        <th scope="col">Year of Diagnosis 1975</th>
                        <th scope="col">Interval</th>
                        <th scope="col">Died</th>
                        <th scope="col">Alive at Start</th>
                        <th scope="col">Lost to Followup</th>
                        <th scope="col">Expected Survival Interval</th>
                        <th scope="col">Relative Survival Cum</th>
                        <th scope="col">pred int</th>
                        <th scope="col">pred cum</th>
                        <th scope="col">pred int se</th>
                        <th scope="col">pred cum se</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>

              <div id="graph-death-tab" class="tab-pane fade">
                <div class="border rounded mb-1">
                  <div class="row">
                    <div class="col-sm-10 border-right">
                      <div class="row">
                        <div class="col-sm-auto m-3">
                          <div class="form-group">
                            <label for="interval-years-death" class="align-self-center ml-1 mr-3">
                              Select years since diagnosis (follow-up) for survival plot and/or trend measures
                            </label>
                            <select id="interval-years-death" class="mx-1" multiple></select>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-auto m-3">
                          <span class="font-weight-bold">Include Trend Measures</span>
                        </div>
                        <div class="col-md-auto m-3">
                          <div class="custom-control custom-checkbox">
                            <input class="custom-control-input" type="checkbox" id="showDeathTrend" />
                            <label class="custom-control-label" for="showDeathTrend" aria-label="showDeathTrend">Between
                              Joinpoints</label>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-2 d-flex pl-0 justify-content-center align-items-center">
                      <div class="row">
                        <div class="col">
                          <button class="btn btn-primary btn-sm recalculate" type="button">Recalculate</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div id="deathTrendTable" class="d-none mb-4">
                  <h4>Percent Change in the Annual Probability of Dying of Cancer by Diagnosis Year</h4>
                  <div class="table-responsive">
                    <table id="trend-dap" class="table table-striped table-condensed condense" tabindex="0">
                      <thead>
                        <tr>
                          <th scope="col">Interval</th>
                          <th scope="col">Start Year</th>
                          <th scope="col">End Year</th>
                          <th scope="col">Estimate pp</th>
                          <th scope="col">Standard Error pp</th>
                          <th scope="col">Lower Limit 95% C.I.</th>
                          <th scope="col">Upper Limit 95% C.I.</th>
                          <th scope="col">Significance</th>
                        </tr>
                      </thead>
                      <tbody></tbody>
                    </table>
                  </div>
                  <div>
                    <sup>Plot: Annotations only available when less than four interval years or four joinpoints are
                      selected.</sup>
                  </div>
                </div>

                <div class="row px-3 mb-1">
                  <button id="addDeathAnno" type="button" class="btn btn-link col-sm-auto addPlotAnno">
                    + Add Annotation
                  </button>
                  <div class="d-flex mb-0 align-self-center form-group col-sm-auto">
                    <label class="mb-0 align-self-center" for="deathFont">Plot Font Size </label>
                    <input type="number" id="deathFont" name="deathFont" class="form-control ml-2 fontControl" min="12"
                      max="20" value="14" />
                  </div>
                  <div id="deathAnnoControl" class="col-sm-auto custom-control custom-checkbox ml-4 align-self-center">
                    <input class="custom-control-input" type="checkbox" id="deathAnno" name="deathAnno" />
                    <label class="custom-control-label" for="deathAnno" aria-label="showTrendsOnGraph">Hide Trend
                      Label</label>
                  </div>
                </div>

                <div class="row">
                  <img class="mx-auto mt-1 d-none" src="" alt="graph-death" />
                  <div id="deathPlot" class="mx-auto mt-1 d-block"></div>
                </div>
                <div class="d-flex">
                  <span id="death-tab-rows" class="mr-auto" style="padding: 0.375rem 0.75rem"></span>
                  <button id="graph-death-dataset-link" class="btn btn-link ml-auto" data-toggle="tooltip"
                    title="Download data used to plot this graph.">
                    Download Graph Dataset
                  </button>
                </div>
                <div class="table-responsive" style="max-height: 500px">
                  <table id="graph-death-table" class="table table-hover table-striped table-condensed condense"
                    tabindex="0">
                    <thead>
                      <tr>
                        <th scope="col">Year of Diagnosis 1975</th>
                        <th scope="col">Interval</th>
                        <th scope="col">Died</th>
                        <th scope="col">Alive at Start</th>
                        <th scope="col">Lost to Followup</th>
                        <th scope="col">Expected Survival Interval</th>
                        <th scope="col">Relative Survival Cum</th>
                        <th scope="col">pred int</th>
                        <th scope="col">pred cum</th>
                        <th scope="col">pred int se</th>
                        <th scope="col">pred cum se</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>

              <div id="graph-time-tab" class="tab-pane fade">
                <div class="border rounded mb-1">
                  <div class="row" id="timeRecalc">
                    <div class="col-md-3 m-3">
                      <div class="form-group">
                        <label for="year-of-diagnosis" class="mx-1 mr-3">Year of Diagnosis</label>
                        <select id="year-of-diagnosis" class="mx-1" multiple="multiple">
                          <option selected>1975</option>
                        </select>
                      </div>
                    </div>
                    <div class="col m-3">
                      <button class="btn btn-primary btn-sm recalculate" type="button">Recalculate</button>
                    </div>
                  </div>
                  <div class="row" id="timeConditionalRecalc" style="display:none">
                    <div class="col-md-3 m-3">
                      <div class="form-group">
                        <label for="conditional-yod" class="mx-1 mr-3">Conditional Year of Diagnosis</label>
                        <select id="conditional-yod" class="mx-1" multiple="multiple">
                          <option selected>1975</option>
                        </select>
                      </div>
                    </div>
                    <div class="col m-3">
                      <button class="btn btn-primary btn-sm" id="conditionalRecalc" type="button">Recalculate</button>
                    </div>
                  </div>
                </div>

                <div class="row px-3 mb-1">
                  <button id="addTimeAnno" type="button" class="btn btn-link col-sm-auto addPlotAnno">
                    + Add Annotation
                  </button>
                  <div class="d-flex mb-0 align-self-center form-group col-sm-auto">
                    <label class="mb-0 align-self-center" for="timeFont"> Plot Font Size </label>
                    <input type="number" id="timeFont" name="timeFont" class="form-control ml-2 fontControl" min="12"
                      max="20" value="14" />
                  </div>
                </div>
                <div class="row">
                  <img class="mx-auto mt-1 d-none" src="" alt="graph-time" />
                  <div id="timePlots" class="mx-auto mt-1 d-block">
                    <div id="timePlot"></div>
                  </div>
                </div>
                <div class="d-flex">
                  <span id="time-tab-rows" class="mr-auto" style="padding: 0.375rem 0.75rem"></span>
                  <button id="graph-time-dataset-link" class="btn btn-link ml-auto" data-toggle="tooltip"
                    title="Download data used to plot this graph.">
                    Download Graph Dataset
                  </button>
                </div>
                <div class="table-responsive">
                  <table id="graph-time-table" class="table table-hover table-striped table-condensed condense"
                    tabindex="0">
                    <thead>
                      <tr>
                        <th scope="col">Year of Diagnosis</th>
                        <th scope="col">Interval</th>
                        <th scope="col">Cumulative Relative Survival</th>
                        <th scope="col">Predicted Cumulative Relative Survival</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
              <!-- Model Estimates Tab -->
              <div id="estimates-tab" class="tab-pane fade">
                <div class="d-flex justify-content-between">
                  <h3 style="margin-bottom: 3px">Estimates of the Joinpoints</h3>
                  <button id="model-estimates-link" class="btn btn-link ml-auto" data-toggle="tooltip"
                    title="Download data used to plot this graph.">
                    Download Model Estimates
                  </button>
                </div>

                <div style="margin: 0px 0px 10px 30px">
                  <span id="yod-range">1975</span>
                </div>
                <div class="table-responsive">
                  <table id="estimates-jp" class="table table-condensed condense" tabindex="0">
                    <thead>
                      <tr>
                        <th scope="col">Estimates</th>
                        <th scope="col">Joinpoint <span id="estimates-jp-selected">0</span></th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>

                <h3>Coefficients</h3>
                <div class="table-responsive">
                  <table id="estimates-coefficients" class="table table-condensed condense" tabindex="0">
                    <thead>
                      <tr>
                        <th scope="col">Parameter</th>
                        <th scope="col">Estimate (%)</th>
                        <th scope="col">Standard Error (%)</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="help" class="container d-none"></div>
  <footer class="text-left text-md-center pt-4 pb-4 text-light bg-primary">
    <div class="container">
      <ul class="list-inline text-light">
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_blank" href="https://www.cancer.gov/">Home</a>
        </li>
        <li class="pb-1 d-none d-md-inline">|</li>
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_top"
            href="mailto:NCIJPSurvWebAdmin@mail.nih.gov?subject=JPSurv">Support</a>
        </li>
        <li class="pb-1 d-none d-md-inline">|</li>
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_blank" href="https://www.cancer.gov/global/web/policies">Policies</a>
        </li>
        <li class="pb-1 d-none d-md-inline">|</li>
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_blank"
            href="https://www.cancer.gov/global/web/policies/accessibility">Accessibility</a>
        </li>
        <li class="pb-1 d-none d-md-inline">|</li>
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_blank" href="https://cancer.gov/global/viewing-files">Viewing Files</a>
        </li>
        <li class="pb-1 d-none d-md-inline">|</li>
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_blank" href="https://www.cancer.gov/global/web/policies/foia">FOIA</a>
        </li>
        <li class="pb-1 d-none d-md-inline">|</li>
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_blank"
            href="https://www.hhs.gov/vulnerability-disclosure-policy/index.html">HHS Vulnerability Disclosure</a>
        </li>
      </ul>
      <ul class="list-inline">
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_blank" href="https://www.hhs.gov/">U.S. Department of Health and Human
            Services</a>
        </li>
        <li class="pb-1 d-none d-md-inline">|</li>
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_blank" href="https://www.nih.gov">National Institutes of Health</a>
        </li>
        <li class="pb-1 d-none d-md-inline">|</li>
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_blank" href="https://www.cancer.gov/">National Cancer Institute</a>
        </li>
        <li class="pb-1 d-none d-md-inline">|</li>
        <li class="pb-1 d-block d-md-inline">
          <a class="text-light m-1" target="_blank" href="https://usa.gov">USA.gov</a>
        </li>
      </ul>
      <div>
        NIH ... Turning Discovery Into Health
        <sup>&reg;</sup>
      </div>
    </div>
  </footer>

  <!-- Small modal -->

  <div id="calculating-spinner" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-sm">
      <div class="modal-content border-0" style="background: inherit">
        <div class="modal-body">
          <i class="fa-solid fa-cog fa-spin fa-10x fa-fw"></i>
        </div>
      </div>
    </div>
  </div>
  <!-- Dialog modal -->

  <div id="ok-alert" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">Rule Validation</h2>
        </div>
        <div class="modal-body">
          <p>...</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
        </div>
      </div>
      <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
  </div>
  <!-- /.modal -->

  <div class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content"></div>
      <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
  </div>
  <!-- /.modal -->

  <script>
    _satellite.pageBottom();
  </script>
</body>

</html>